<!doctype html>
  <html>
    <head>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@4.19.0/css/xterm.css" />
      <link rel="stylesheet" href="style.css">
      <link rel="stylesheet" href="main.css">
      <script src="https://cdn.jsdelivr.net/npm/xterm@4.19.0/lib/xterm.js"></script>
      <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    </head>
    <body class="">
      <header>
        <h1 class="text-5xl text-center mt-16"><span class="font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-500 to-indigo-500">Convert Your Code into </span> 
            <span class="bg-indigo-500 px-3 text-white font-bold rounded-md">APK</span></h1>
    </header>
     <script>
        function getURL() {
          var myform = document.getElementById("gitbox");
          var formData = new FormData(myform);
          var object = {};
          formData.forEach((value, key) => object[key] = value);
          var path_url = object.links;
          var path_array=path_url.split('/');
          var path = path_array[4]
          return "http://localhost:3000/static/"+path+"/app-release.apk";
          //  fetch("http://localhost:3000/static/"+path+"/app-release.apk")
        }
     </script>
    <main class="text-center m-8 p-8 w-2/3 mx-auto">
      <div id="terminal"></div>
    
    <form id="gitbox" class="mt-8 text-center">
      <input class="border-2 border-cyan-500 w-1/2 px-2 py-1.5 mb-2 rounded-md"  type="text" id="links" name="links"/>
      <button id="run-button" class="font-bold text-white px-6 py-2 bg-gradient-to-r from-cyan-500 to-indigo-500 rounded-md" type="submit">RUN</button>
    </form>
    <!-- <a href="#" onClick="document.location.href=getURL();">DOWNLOAD APK</a> -->

    <button id="download-button" onClick="document.location.href=getURL();" class="font-bold text-white px-6 py-2 bg-gradient-to-r from-cyan-500 to-indigo-500 rounded-md " type="submit" ><div> <h3>Download APK </h3></div></button>
    
    </main>
    </body>
    <script src="frontend.js"></script>

    <script>
      var myform = document.getElementById("gitbox");
      const downloadButtonContent = document.querySelector('#download-button div');
      const downloadButton = document.querySelector('#download-button');

      myform.addEventListener("submit", submitForm);

     async  function submitForm(e)
     {
     e.preventDefault();
 
    var myform =  document.getElementById("gitbox");
    
    var formData = new FormData(myform);
    var object = {};
    formData.forEach((value, key) => object[key] = value);
    var json = JSON.stringify(object);
    console.log(json)


    // downloadButtonContent.classList.add('loading');


      const response = await fetch("http://localhost:3000/git-url", {
      method: "POST",
      headers: {'Content-Type': 'application/json'},
      body: json
    });

       // console.log(response.body);
       // downloadButtonContent.classList.remove('loading');
       // downloadButton.removeAttribute("disabled");
       // downloadButtonContent.classList.add('active');


    }
    </script>



  </html>

